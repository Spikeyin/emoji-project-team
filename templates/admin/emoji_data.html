{% extends "base.html" %}

{% block title %}è¡¨æƒ…æ•°æ®{% endblock %}

{% block content %}
<div class="content-box">
    <h1>è¡¨æƒ…æ•°æ®æŸ¥çœ‹</h1>

    <div class="filter-bar">
        <form method="GET" action="{{ url_for('admin.emoji_data') }}" class="inline-form">
            <select name="course_id" onchange="this.form.submit()">
                <option value="">å…¨éƒ¨è¯¾ç¨‹</option>
                {% for course in courses %}
                <option value="{{ course.id }}" {% if course.id==selected_course_id %}selected{% endif %}>
                    {{ course.course_name }}
                </option>
                {% endfor %}
            </select>
        </form>

        <a href="{{ url_for('admin.export', course_id=selected_course_id or '', days=30) }}" class="btn btn-primary">
            ğŸ’¾ å¯¼å‡ºæ•°æ®
        </a>
    </div>

    {% if records %}
    <div class="table-responsive">
        <table class="data-table">
            <thead>
                <tr>
                    <th>è¯¾ç¨‹</th>
                    <th>è¡¨æƒ…</th>
                    <th>æƒ…ç»ª</th>
                    <th>æ—¥æœŸ</th>
                    <th>æ—¶é—´</th>
                    <th>è¡¥å……è¯´æ˜</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>
                        {% if record.course_name %}
                        {{ record.course_name }} ({{ record.course_code }})
                        {% else %}
                        è¯¾ç¨‹ID: {{ record.course_id }}
                        {% endif %}
                    </td>
                    <td class="emoji-cell">{{ record.emoji }}</td>
                    <td>{{ record.emoji_name }}</td>
                    <td>{{ record.session_date }}</td>
                    <td>{{ record.time_formatted }}</td>
                    <td>{{ record.comment or '-' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <p class="table-info">æ˜¾ç¤ºæœ€è¿‘ {{ records|length }} æ¡è®°å½•ï¼ˆæŒ‰åŒ¿ååŸåˆ™ï¼Œä¸æ˜¾ç¤ºå­¦ç”Ÿèº«ä»½ï¼‰</p>
    {% else %}
    <p class="empty-state">æš‚æ— è¡¨æƒ…æ•°æ®</p>
    {% endif %}
</div>
{% endblock %}